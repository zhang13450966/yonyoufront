!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],e):"object"==typeof exports?exports["hpf/hpfc/m0z10202/action/index"]=e(require("nc-lightapp-front")):t["hpf/hpfc/m0z10202/action/index"]=e(t["nc-lightapp-front"])}(window,(function(t){return function(t){var e={};function a(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(o,s,function(e){return t[e]}.bind(null,s));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="../../../../",a(a.s=48)}({0:function(e,a){e.exports=t},48:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initTemplate=function(t,e){var a=this;t.createUIDom({pagecode:n},(function(o){if(o){if(o.template){var s=o.template;s=b.call(a,t,s),t.meta.setMeta(s),o.context.pk_org&&(a.setState({pk_org:o.context.pk_org}),a.setState({org_Name:o.context.org_Name}))}if(o.button){var n=o.button;t.button.setButtons(n),t.button.setButtonDisabled({Delete:!0}),t.button.setButtonDisabled({Edit:!0}),t.button.setPopContent("DelLine",a.state.json["M0Z10202-000019"])}}e()}))},e.onloaddata=function(){this.props.button.setButtonsVisible({Save:!1,Cancel:!1});var t=this.props.search.getAllSearchData("search",!1),e={};t&&0!=t.conditions.length&&(e=t);var a={querycondition:e,pageInfo:this.props.editTable.getTablePageInfo("head"),pagecode:n,queryAreaCode:"search",oid:this.props.meta.getMeta().search.oid,querytype:"tree"};p.call(this,!1,a)},e.onClickButton=function(t,e){var a=this,l=t.editTable.getCheckedRows("head"),b=t.editTable.getTablePageInfo("head"),f=this.state.hasSearched&&1==this.state.hasSearched?t.search.getAllSearchData("search",!1):null,g=this.props.meta.getMeta().search.oid,v={pageInfo:b,querycondition:null==f?{}:f,pagecode:n,queryAreaCode:"search",oid:g,querytype:"tree"};switch(e){case"Add":t.editTable.setStatus("head","edit");var y=this.props.editTable.getNumberOfRows("head");t.editTable.addRow("head",y,!0),t.button.setButtonsVisible("Edit",!1),t.button.setMainButton("Add",!1);break;case"Cancel":(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10202-000006"],content:this.state.json["M0Z10202-000007"],beSureBtnClick:function(){t.editTable.cancelEdit("head"),t.editTable.setStatus("head","browse"),t.button.setButtonDisabled("Edit",!0),t.button.setMainButton("Add",!0),t.button.setButtonDisabled("Delete",!0),u.call(a)}});break;case"Down":t.modal.show("selds");break;case"Edit":t.editTable.setStatus("head","edit"),t.button.setButtonsVisible("Edit",!1),t.button.setMainButton("Add",!1);break;case"Save":t.editTable.filterEmptyRows("head",r);var w=t.editTable.getAllData("head");if(!w||0===w.length)return t.editTable.cancelEdit("head"),t.editTable.setStatus("head","browse"),t.button.setButtonsVisible("Edit",!0),t.button.setMainButton("Add",!0),void u.call(this);if(!t.editTable.checkRequired("head",w.rows))return;t.editTable.setStatus("head","browse");var T={pageid:n,model:{pageInfo:b,rows:w.rows,areaType:"table",areacode:"head"}};this.props.validateToSave(T,(function(){(0,o.ajax)({url:i.saveUrl,data:T,success:function(e){if(this.props.editTable.setStatus("head","browse"),e.data){var a=this.props.editTable.getAllData("head");!function(t,e){if(!e)return;t.rows&&t.rows.forEach((function(a,o){e.forEach((function(e,s){e.rowid===a.rowid&&(t.rows[o]=e)}))}))}(a,e.data.head.rows),this.props.editTable.setTableData("head",a),(0,o.toast)({color:"success",title:this.state.json["M0Z10202-000008"]})}t.button.setButtonDisabled("Edit",!0),t.button.setMainButton("Add",!0),t.button.setButtonDisabled("Delete",!0),u.call(this)}.bind(a)})}),s({},"head","editTable"),"grid");break;case"Delete":if(0!=l.length)if(t.editTable.getStatus("head")&&"edit"==t.editTable.getStatus("head")){var m=l.map((function(t){return t.index}));t.editTable.deleteTableRowsByIndex("head",m)}else{var S=l.map((function(t){return{status:"3",values:t.data.values}})),D={pageid:n,model:{areaType:"table",pageInfo:b,rows:S}};(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10202-000009"],content:this.state.json["M0Z10202-000010"],beSureBtnClick:d.bind(this,D,v)})}else(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10202-000011"],content:this.state.json["M0Z10202-000012"]});break;case"PrintGrp":case"Print":c.call(this);break;case"Output":h.call(this);break;case"Refresh":p.call(this,!1,v),(0,o.toast)({title:this.state.json["M0Z10202-000020"],color:"success"})}},e.beSureBtnClick=function(t){var e=this.state.dbinfo;if(0==Object.keys(e).length)return void(0,o.toast)({color:"warning",title:"来源系统不能为空!"});(0,o.ajax)({url:i.downUrl,data:{ref1:this.state.dbinfo},async:!1,success:function(e){var a=e.success,s=e.data;a?(0,o.toast)({color:"success",title:s}):(0,o.toast)({color:"success",title:"下载失败"}),t.modal.close("selds")}});t.editTable.getCheckedRows("head");var a=t.editTable.getTablePageInfo("head"),s=t.search.getAllSearchData("search",!1),r=this.props.meta.getMeta().search.oid,l={pageInfo:a,querycondition:null==s?{}:s,pagecode:n,queryAreaCode:"search",oid:r,querytype:"tree"};p.call(this,!1,l)},e.cancelBtnClick=function(){this.setState({pk_entryconfig:""})},e.onSelected=function(){var t=this.props.editTable.getCheckedRows("head"),e=!(t&&t.length>0);this.props.button.setButtonDisabled(["Delete"],e),this.props.button.setButtonDisabled(["Edit"],e),this.setState(this.state)},e.gridBeChecked=l,e.gridStatusChange=u,e.onClickPageInfo=function(t,e,a){var o=t.editTable.getTablePageInfo("head"),s=t.search.getAllSearchData("search"),n={pks:a,pageInfo:o,querycondition:s};p.call(this,!1,n,"pageQueryUrl")},e.onSearchAfterEvent=function(t){var e=t.search.getAllSearchData("search");if(e&&0!=e.conditions.length){var a=e.conditions.find((function(t){return"pk_org"==t.field}));this.setState({dbinfo:null,pk_org:a.value.firstvalue}),t.editTable.getStatus()&&"edit"==t.editTable.getStatus()&&(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10201-000011"],content:this.state.json["M0Z10201-000015"]});var s=this.props.meta.getMeta().search.oid,r={querycondition:null==e?{}:e,pageInfo:t.editTable.getTablePageInfo("head"),pagecode:n,queryAreaCode:"search",oid:s,querytype:"tree"};p.call(this,!0,r)}else this.setState({pk_org:""}),t.editTable.setTableData("head",{rows:[]},!1)},e.onClickSearchBtn=function(t,e){t.editTable.getStatus()&&"edit"==t.editTable.getStatus()&&(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10202-000011"],content:this.state.json["M0Z10202-000015"]});var a=this.props.meta.getMeta().search.oid,s={querycondition:null==e?{}:e,pageInfo:t.editTable.getTablePageInfo("head"),pagecode:n,queryAreaCode:"search",oid:a,querytype:"tree"};p.call(this,!0,s)};var o=a(0);function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var n="M0Z10202_cust",r=["iseucountry"],i={queryUrl:"/nccloud/hpf/cust/CustQuery.do",pageQueryUrl:"/nccloud/hpf/cust/CustQueryPageGridByPks.do",saveUrl:"/nccloud/hpf/cust/CustSave.do",printUrl:"/nccloud/hpf/cust/CustPrint.do",downUrl:"/nccloud/hpf/cust/CustDown.do"};function l(t){var e=t.editTable.getCheckedRows("head").length;t.button.setDisabled({btnDel:0===e})}function u(){var t=this.props.editTable.getStatus("head");this.props.button.setButtonsVisible({Save:"browse"!==t,Cancel:"browse"!==t,Add:"browse"===t,Edit:"browse"===t,Delete:"browse"===t,Refresh:"browse"===t,PrintGrp:"browse"===t,Output:"browse"===t}),this.props.button.setPopContent("DelLine","browse"===t?this.state.json["M0Z10202-000000"]:"")}function d(t,e){var a=this;(0,o.ajax)({url:i.saveUrl,data:t,success:function(t){t.success?(a.props.button.setButtonDisabled(["Delete"],!0),p.call(a,!1,e),(0,o.toast)({color:"success",title:a.state.json["M0Z10202-000002"]})):alert(t.message)}})}function c(){var t=this.props.editTable.getAllData("head");if(0!==t.length){var e=[];t.rows.forEach((function(t,a){e.push(t.values.pk_country.value)})),(0,o.print)("pdf",i.printUrl,{funcode:"M0Z10202",nodekey:null,oids:e})}else(0,o.toast)({content:this.state.json["M0Z10202-000013"],color:"warning"})}function h(){var t=this.props.editTable.getAllData("head");if(0!==t.length){var e=[];t.rows.forEach((function(t,a){e.push(t.values.true.value)})),this.setState({ids:e},this.refs.printOutput.open())}else(0,o.toast)({content:this.state.json["M0Z10202-000014"],color:"warning"})}function p(t,e,a){var n=this,r=this,l=null==a?"queryUrl":a;void 0!==e.querycondition.conditions&&(e.querycondition.conditions&&0==e.querycondition.conditions.length||(0,o.ajax)({url:i[l],data:e,success:function(e){var a=e.success,i=e.data;if(a){if(e.formulamsg&&e.formulamsg instanceof Array&&e.formulamsg.length>0&&r.props.dealFormulamsg(e.formulamsg,s({},"head","table")),e.hasOwnProperty("data")&&null!=i)r.props.editTable.setTableData("head",i.head),r.props.button.setButtonDisabled({PrintGrp:!1,Output:!1,Delete:!0,Edit:!0});else{r.props.editTable.setTableData("head",{rows:[]}),r.props.button.setButtonDisabled({PrintGrp:!0,Output:!0,Delete:!0,Edit:!0})}r.props.editTable.setStatus("browse"),!0===t&&(0,o.toast)({color:"success",content:n.state.json["M0Z10202-000003"]+i.head.allpks.length+n.state.json["M0Z10202-000004"]}),n.setState({hasSearched:!0})}},error:function(e){!0===t&&(0,o.toast)({color:"warning",content:n.state.json["M0Z10202-000005"]})}}))}function b(t,e){return e.head.showindex=!0,e.head.status="browse",e.head.pagination=!1,e.search.items.map((function(e){"pk_org"===e.attrcode&&(e.queryCondition=function(){return{funcode:t.getSearchParam("c"),TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}})})),e}}})}));