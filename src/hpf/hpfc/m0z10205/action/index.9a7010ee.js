!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],t):"object"==typeof exports?exports["hpf/hpfc/m0z10205/action/index"]=t(require("nc-lightapp-front")):e["hpf/hpfc/m0z10205/action/index"]=t(e["nc-lightapp-front"])}(window,(function(e){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=52)}({0:function(t,a){t.exports=e},52:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=function(e,t){var a=this;e.createUIDom({pagecode:s},(function(o){if(o){if(o.template){var n=o.template;o.context.pk_org&&a.setState({pk_org:o.context.pk_org}),n=b.call(a,e,n),e.meta.setMeta(n)}if(o.button){var s=o.button;e.button.setButtons(s),e.button.setButtonDisabled({Delete:!0}),e.button.setButtonDisabled({Edit:!0}),e.button.setPopContent("DelLine",a.state.json["M0Z10205-000019"])}}t()}))},t.onloaddata=function(){this.props.button.setButtonsVisible({Save:!1,Cancel:!1});var e=this.props.search.getAllSearchData("search",!1),t={};e&&0!=e.conditions.length&&(t=e);var a={querycondition:t,pageInfo:this.props.editTable.getTablePageInfo("head"),pagecode:s,queryAreaCode:"search",oid:this.props.meta.getMeta().search.oid,querytype:"tree"};p.call(this,!1,a)},t.onClickButton=function(e,t){var a=this,l=e.editTable.getCheckedRows("head"),b=e.editTable.getTablePageInfo("head"),f=this.state.hasSearched&&1==this.state.hasSearched?e.search.getAllSearchData("search",!1):null,g=this.props.meta.getMeta().search.oid,y={pageInfo:b,querycondition:null==f?{}:f,pagecode:s,queryAreaCode:"search",oid:g,querytype:"tree"};switch(t){case"Add":e.editTable.setStatus("head","edit");var v=this.props.editTable.getNumberOfRows("head");e.editTable.addRow("head",v,!0),e.button.setButtonsVisible("Edit",!1),e.button.setMainButton("Add",!1);break;case"Cancel":(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10205-000006"],content:this.state.json["M0Z10205-000007"],beSureBtnClick:function(){e.editTable.cancelEdit("head"),e.editTable.setStatus("head","browse"),e.button.setButtonDisabled("Edit",!0),e.button.setMainButton("Add",!0),e.button.setButtonDisabled("Delete",!0),d.call(a)}});break;case"Down":e.modal.show("selds");break;case"Edit":e.editTable.setStatus("head","edit"),e.button.setButtonsVisible("Edit",!1),e.button.setMainButton("Add",!1);break;case"Save":e.editTable.filterEmptyRows("head",r);var w=e.editTable.getAllData("head");if(!w||0===w.length)return e.editTable.cancelEdit("head"),e.editTable.setStatus("head","browse"),e.button.setButtonsVisible("Edit",!0),e.button.setMainButton("Add",!0),void d.call(this);if(!e.editTable.checkRequired("head",w.rows))return;e.editTable.setStatus("head","browse");var T={pageid:s,model:{pageInfo:b,rows:w.rows,areaType:"table",areacode:"head"}};this.props.validateToSave(T,(function(){(0,o.ajax)({url:i.saveUrl,data:T,success:function(t){if(this.props.editTable.setStatus("head","browse"),t.data){var a=this.props.editTable.getAllData("head");!function(e,t){if(!t)return;e.rows&&e.rows.forEach((function(a,o){t.forEach((function(t,n){t.rowid===a.rowid&&(e.rows[o]=t)}))}))}(a,t.data.head.rows),this.props.editTable.setTableData("head",a),(0,o.toast)({color:"success",title:this.state.json["M0Z10205-000008"]})}e.button.setButtonDisabled("Edit",!0),e.button.setMainButton("Add",!0),e.button.setButtonDisabled("Delete",!0),d.call(this)}.bind(a)})}),n({},"head","editTable"),"grid");break;case"Delete":if(0!=l.length)if(e.editTable.getStatus("head")&&"edit"==e.editTable.getStatus("head")){var m=l.map((function(e){return e.index}));e.editTable.deleteTableRowsByIndex("head",m)}else{var S=l.map((function(e){return{status:"3",values:e.data.values}})),D={pageid:s,model:{areaType:"table",pageInfo:b,rows:S}};(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10205-000009"],content:this.state.json["M0Z10205-000010"],beSureBtnClick:c.bind(this,D,y)})}else(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10205-000011"],content:this.state.json["M0Z10205-000012"]});break;case"PrintGrp":case"Print":u.call(this);break;case"Output":h.call(this);break;case"Refresh":p.call(this,!1,y),(0,o.toast)({title:this.state.json["M0Z10205-000020"],color:"success"})}},t.beSureBtnClick=function(e){var t=this.state.dbinfo;if(0==Object.keys(t).length)return void(0,o.toast)({color:"warning",title:"来源系统不能为空!"});(0,o.ajax)({url:i.downUrl,data:{ref1:this.state.dbinfo},async:!1,success:function(t){var a=t.success,n=t.data;a?(0,o.toast)({color:"success",title:n}):(0,o.toast)({color:"success",title:"下载失败"}),e.modal.close("selds")}});e.editTable.getCheckedRows("head");var a=e.editTable.getTablePageInfo("head"),n=e.search.getAllSearchData("search",!1),r=this.props.meta.getMeta().search.oid,l={pageInfo:a,querycondition:null==n?{}:n,pagecode:s,queryAreaCode:"search",oid:r,querytype:"tree"};p.call(this,!1,l)},t.cancelBtnClick=function(){this.setState({pk_entryconfig:""})},t.onSelected=function(){var e=this.props.editTable.getCheckedRows("head"),t=!(e&&e.length>0);this.props.button.setButtonDisabled(["Delete"],t),this.props.button.setButtonDisabled(["Edit"],t),this.setState(this.state)},t.gridBeChecked=l,t.gridStatusChange=d,t.onClickPageInfo=function(e,t,a){var o=e.editTable.getTablePageInfo("head"),n=e.search.getAllSearchData("search"),s={pks:a,pageInfo:o,querycondition:n};p.call(this,!1,s,"pageQueryUrl")},t.onSearchAfterEvent=function(e){var t=e.search.getAllSearchData("search");if(t&&0!=t.conditions.length){var a=t.conditions.find((function(e){return"pk_org"==e.field}));this.setState({dbinfo:null,pk_org:a.value.firstvalue}),e.editTable.getStatus()&&"edit"==e.editTable.getStatus()&&(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10201-000011"],content:this.state.json["M0Z10201-000015"]});var n=this.props.meta.getMeta().search.oid,r={querycondition:null==t?{}:t,pageInfo:e.editTable.getTablePageInfo("head"),pagecode:s,queryAreaCode:"search",oid:n,querytype:"tree"};p.call(this,!0,r)}else this.setState({pk_org:""}),e.editTable.setTableData("head",{rows:[]},!1)},t.onClickSearchBtn=function(e,t){e.editTable.getStatus()&&"edit"==e.editTable.getStatus()&&(0,o.promptBox)({color:"warning",title:this.state.json["M0Z10205-000011"],content:this.state.json["M0Z10205-000015"]});var a=this.props.meta.getMeta().search.oid,n={querycondition:null==t?{}:t,pageInfo:e.editTable.getTablePageInfo("head"),pagecode:s,queryAreaCode:"search",oid:a,querytype:"tree"};p.call(this,!0,n)};var o=a(0);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s="M0Z10205_payorg",r=["iseucountry"],i={queryUrl:"/nccloud/hpf/payorg/PayorgQuery.do",pageQueryUrl:"/nccloud/hpf/payorg/PayorgQueryPageGridByPks.do",saveUrl:"/nccloud/hpf/payorg/PayorgSave.do",printUrl:"/nccloud/hpf/payorg/PayorgPrint.do",downUrl:"/nccloud/hpf/payorg/PayorgDown.do"};function l(e){var t=e.editTable.getCheckedRows("head").length;e.button.setDisabled({btnDel:0===t})}function d(){var e=this.props.editTable.getStatus("head");this.props.button.setButtonsVisible({Save:"browse"!==e,Cancel:"browse"!==e,Add:"browse"===e,Edit:"browse"===e,Delete:"browse"===e,Refresh:"browse"===e,PrintGrp:"browse"===e,Output:"browse"===e}),this.props.button.setPopContent("DelLine","browse"===e?this.state.json["M0Z10205-000000"]:"")}function c(e,t){var a=this;(0,o.ajax)({url:i.saveUrl,data:e,success:function(e){e.success?(a.props.button.setButtonDisabled(["Delete"],!0),p.call(a,!1,t),(0,o.toast)({color:"success",title:a.state.json["M0Z10205-000002"]})):alert(e.message)}})}function u(){var e=this.props.editTable.getAllData("head");if(0!==e.length){var t=[];e.rows.forEach((function(e,a){t.push(e.values.pk_country.value)})),(0,o.print)("pdf",i.printUrl,{funcode:"M0Z10205",nodekey:null,oids:t})}else(0,o.toast)({content:this.state.json["M0Z10205-000013"],color:"warning"})}function h(){var e=this.props.editTable.getAllData("head");if(0!==e.length){var t=[];e.rows.forEach((function(e,a){t.push(e.values.true.value)})),this.setState({ids:t},this.refs.printOutput.open())}else(0,o.toast)({content:this.state.json["M0Z10205-000014"],color:"warning"})}function p(e,t,a){var s=this,r=this,l=null==a?"queryUrl":a;void 0!==t.querycondition.conditions&&(t.querycondition.conditions&&0==t.querycondition.conditions.length||(0,o.ajax)({url:i[l],data:t,success:function(t){var a=t.success,i=t.data;if(a){if(t.formulamsg&&t.formulamsg instanceof Array&&t.formulamsg.length>0&&r.props.dealFormulamsg(t.formulamsg,n({},"head","table")),t.hasOwnProperty("data")&&null!=i)r.props.editTable.setTableData("head",i.head),r.props.button.setButtonDisabled({PrintGrp:!1,Output:!1,Delete:!0,Edit:!0});else{r.props.editTable.setTableData("head",{rows:[]}),r.props.button.setButtonDisabled({PrintGrp:!0,Output:!0,Delete:!0,Edit:!0})}r.props.editTable.setStatus("browse"),!0===e&&(0,o.toast)({color:"success",content:s.state.json["M0Z10205-000003"]+i.head.allpks.length+s.state.json["M0Z10205-000004"]}),s.setState({hasSearched:!0})}},error:function(t){!0===e&&(0,o.toast)({color:"warning",content:s.state.json["M0Z10205-000005"]})}}))}function b(e,t){return t.head.showindex=!0,t.head.status="browse",t.head.pagination=!1,t.search.items.map((function(t){"pk_org"===t.attrcode&&(t.queryCondition=function(){return{funcode:e.getSearchParam("c"),TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}})})),t}}})}));