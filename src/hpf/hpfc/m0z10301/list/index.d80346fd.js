!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react"],t):"object"==typeof exports?exports["hpf/hpfc/m0z10301/list/index"]=t(require("nc-lightapp-front"),require("react")):e["hpf/hpfc/m0z10301/list/index"]=t(e["nc-lightapp-front"],e.React)}(window,(function(e,t){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=79)}({0:function(t,a){t.exports=e},1:function(e,a){e.exports=t},20:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listCreate=function(e){e.pushTo(n.REQUEST_URL.toCard,{status:n.STATUS.add,pagecode:n.CARD.page_code})},t.listRefresh=s,t.listEdit=function(e,t){e.pushTo(n.REQUEST_URL.toCard,{status:n.STATUS.edit,id:t,pagecode:n.CARD.page_code})},t.listCopy=function(e,t){e.pushTo(n.REQUEST_URL.toCard,{status:n.STATUS.edit,id:t,pagecode:n.CARD.page_code,isCopy:!0})},t.listCommit=function(e,t){var a=this;if(!t){var r=i(e,!1);if(!r.valid)return;if(r.valid){var c=r.selectDatas,d=c&&c.map((function(e){return e.data.values[n.PRIMARY_KEY.head_id].value})),u=new Map;c&&c.map((function(e){var t=e.data.values[n.PRIMARY_KEY.head_id].value,a=e.data.values[n.FIELD.ts]&&e.data.values[n.FIELD.ts].value;t&&a&&u.set(t,a)})),t={pks:d,pkMapTs:u}}}(0,o.ajax)({url:n.REQUEST_URL.commit,data:t,success:function(o){o.success?o.data&&o.data.workflow&&("approveflow"==o.data.workflow||"workflow"==o.data.workflow)?(a.setState({compositeData:o.data,compositeDisplay:!0,curPk:t.pks}),l.call(a,o)):(l.call(a,o),s(e)):l.call(a,o)}})},t.listUnCommit=function(e,t){if(!t){var a=i(e,!1);if(a.valid){var r=a.selectDatas,l=r&&r.map((function(e){return e.data.values[n.PRIMARY_KEY.head_id].value})),c=new Map;r&&r.map((function(e){var t=e.data.values[n.PRIMARY_KEY.head_id].value,a=e.data.values[n.FIELD.ts]&&e.data.values[n.FIELD.ts].value;t&&a&&c.set(t,a)})),t={pks:l,pkMapTs:c}}}(0,o.ajax)({url:n.REQUEST_URL.unCommit,data:t,success:function(t){t.success?s(e):(0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000017"]})}})},t.checkSelected=i,t.listAttachment=function(e){var t=i(e,!0);if(t.valid){var a=t.selectDatas,o=a[0]&&a[0].data.values[n.PRIMARY_KEY.head_id].value,s=a[0]&&a[0].data.values[n.PRIMARY_KEY.bill_no].value;this.setState({showUploader:!this.state.showUploader,billInfo:{billId:o,billNo:s}})}},t.listBillTrack=function(e){var t=i(e,!0);if(t.valid){var a=t.selectDatas,o=a[0]&&a[0].data.values[n.PRIMARY_KEY.head_id].value;this.setState({showBillTrack:!0,billTrackBillId:o,billTrackBillType:n.BILL_TYPE_CODE})}},t.listLinkApprove=function(e){var t=i(e,!0);if(t.valid){var a=t.selectDatas,o=a[0]&&a[0].data.values[n.PRIMARY_KEY.head_id].value;this.setState({showApproveDetail:!0,billId:o})}},t.listHeadDelete=function(e){var t={},a=[],s=i(e,!1);if(s.valid){var r=s.selectDatas;a=r&&r.map((function(e){return e.data.values[n.PRIMARY_KEY.head_id].value}));var l=new Map;r&&r.map((function(e){var t=e.data.values[n.PRIMARY_KEY.head_id].value,a=e.data.values[n.FIELD.ts]&&e.data.values[n.FIELD.ts].value;t&&a&&l.set(t,a)})),t={pks:a,pkMapTs:l},(0,o.ajax)({url:n.REQUEST_URL.delete,data:t,success:function(t){if(t.success){var s=e.table.getAllTableData(n.LIST.table_id),i=s.rows[0]&&s.rows.map((function(e){return e.values[n.PRIMARY_KEY.head_id].value})),r=a.map((function(e){return i.findIndex((function(t){return t==e}))})).filter((function(e){return-1!=e}));e.table.deleteCacheId(n.LIST.table_id,a),e.table.deleteTableRowsByIndex(n.LIST.table_id,r),(0,o.toast)({color:n.STATUS.success,content:e.json["M0Z10301-000005"]})}else(0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000009"]})}})}},t.listBodyDelete=function(e,t,a){(0,o.ajax)({url:n.REQUEST_URL.delete,data:t,success:function(s){s.success?(e.table.deleteCacheId(n.LIST.table_id,t.pks[0]),e.table.deleteTableRowsByIndex(n.LIST.table_id,a),(0,o.toast)({color:n.STATUS.success,content:e.json["M0Z10301-000005"]})):(0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000009"]})}})},t.listSearch=r,t.pageInfoClick=function(e,t,a){var s={pks:a,pagecode:n.LIST.page_code};(0,o.ajax)({url:n.REQUEST_URL.queryListByPks,data:s,success:function(t){var a=t.success,s=t.data;a&&s&&s[n.LIST.table_id]?(e.table.setAllTableData(n.LIST.table_id,s[n.LIST.table_id]),(0,o.toast)({color:n.STATUS.success})):(e.table.setAllTableData(n.LIST.table_id,{rows:[]}),(0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000010"]}))}})},t.PromptMessage=l,t.handleDoubleClick=function(e,t,a){a.pushTo(n.REQUEST_URL.toCard,{status:n.STATUS.browse,id:e[n.PRIMARY_KEY.head_id].value,idissys:e[n.FIELD.idissys].value,idissysbilltype:e[n.FIELD.idissysbilltype].value,pagecode:n.CARD.page_code,scene:a.getUrlParam("scene")})},t.initDataBefore=function(e){var t=e.search.getSearchValByField(n.LIST.search_id,"pk_org").value.firstvalue,a=t.split(",");t&&1==a.length?(0,o.ajax)({url:n.REQUEST_URL.setInitDataBefore,data:{pk_org:a[0]},success:function(t){t.data.value?c(e,t.data.pk_org):(0,o.promptBox)({color:"warning",title:"提示",content:"当前业务单元"+t.data.orgName+"存在数据汇总规则数据，是否删除原有的数据重新预置数据！",noFooter:!1,noCancelBtn:!1,beSureBtnName:"是",cancelBtnName:"否",hasCloseBtn:!0,beSureBtnClick:function(){return c(e,t.data.pk_org)},closeByClickBackDrop:!1})}}):(0,o.toast)({color:"danger",content:"请选择一个业务单元进行初始化"})},t.initData=c,t.onPrint=function(e){var t=e.table.getAllTableData(n.LIST.table_id);if(0===t.rows.length)return void(0,o.toast)({color:n.STATUS.warning,content:"无可打印数据"});var a=t.allpks;(0,o.print)("pdf",n.REQUEST_URL.print,{funcode:e.appcode,nodekey:"M0Z10301",oids:a,outputType:"output"})},t.onOutput=function(e){var t=e.table.getAllTableData(n.LIST.table_id);if(0===t.rows.length)return void(0,o.toast)({color:n.STATUS.warning,content:"无可输出的数据"});var a=t.allpks;this.setState({ids:a},this.refs.printOutput.open())};var o=a(0),n=a(4);function s(e){r(e,(0,o.cardCache.getDefData)(n.SEARCH_CACHE.key,n.SEARCH_CACHE.dataSource))}function i(e,t){var a=!0,s=e.table&&e.table.getCheckedRows(n.LIST.table_id);return t&&s.length>1?((0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000012"]}),a=!1):0==s.length&&((0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000013"]}),a=!1),{valid:a,selectDatas:s}}function r(e,t){var a,s,i,r=e.table.getTablePageInfo(n.LIST.table_id);t||(t=e.search.getQueryInfo(n.LIST.search_id)),t.pageInfo=r,t.pageCode=n.LIST.page_code,e.button.setDisabled((a={},s=n.LIST_BUTTON.refresh,i=!1,s in a?Object.defineProperty(a,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[s]=i,a)),(0,o.ajax)({url:n.REQUEST_URL.queryList,data:t,success:function(a){var s=a.success,i=a.data;a.formulamsg&&a.formulamsg instanceof Array&&a.formulamsg.length>0&&e.dealFormulamsg(a.formulamsg),s&&i&&i[n.LIST.table_id]?(e.table.setAllTableData(n.LIST.table_id,i[n.LIST.table_id]),(0,o.toast)({color:n.STATUS.success})):(e.table.setAllTableData(n.LIST.table_id,{rows:[]}),(0,o.toast)({color:n.STATUS.warning,content:e.json["M0Z10301-000010"]})),(0,o.cardCache.setDefData)(n.SEARCH_CACHE.key,n.SEARCH_CACHE.dataSource,t)}})}function l(e){var t=e.data,a=t.status,n=t.msg,s=void 0;s=(s=(s="共提交"+e.data.total+"条")+",成功"+e.data.successNum+"条")+",失败"+e.data.failNum+",条";var i=e.data.errormessages;0==a?(0,o.toast)({color:"success",title:"提交"+n,content:s,TextArr:["展开","收起","关闭"],groupOperation:!0}):1==a?(0,o.toast)({duration:"infinity",color:"danger",title:"提交"+n,content:s,TextArr:["展开","收起","关闭"],groupOperation:!0,groupOperationMsg:i}):2==a&&(0,o.toast)({duration:"infinity",color:"warning",title:"提交"+n,content:s,TextArr:["展开","收起","关闭"],groupOperation:!0,groupOperationMsg:i})}function c(e,t){(0,o.ajax)({url:n.REQUEST_URL.setInitData,data:{pk_org:t,flag_clear:!0},success:function(t){(0,o.toast)({content:"初始化成功"});var a=(0,o.cardCache.getDefData)(n.SEARCH_CACHE.key,n.SEARCH_CACHE.dataSource);r(e,a)}})}},38:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectedEvent=function(e,t,a,n,s){e.button.setButtonDisabled(o.LIST_DISABLED_BUTTON,!0);var i=[],r=!0,l=!0,c=!0,d=e.table.getCheckedRows(o.LIST.table_id);if(0==d.length)return;if(d.length>1){i=[o.LIST_BUTTON.print,o.LIST_BUTTON.output];var u=!0,p=!1,T=void 0;try{for(var f,m=d[Symbol.iterator]();!(u=(f=m.next()).done);u=!0){var h=f.value.data.values[o.FIELD.billStatus].value;h==o.STATUS.PASSING||h==o.STATUS.COMMIT||h==o.STATUS.GOINGON?(l=!1,r=!1):h==o.STATUS.NOSTATE&&(c=!1)}}catch(e){p=!0,T=e}finally{try{!u&&m.return&&m.return()}finally{if(p)throw T}}r&&i.push(o.LIST_BUTTON.delete),l&&i.push(o.LIST_BUTTON.commit),c&&i.push(o.LIST_BUTTON.unCommit),e.button.setButtonDisabled(i,!1)}else{var v=d[0].data.values[o.FIELD.billStatus]&&d[0].data.values[o.FIELD.billStatus].value;v==o.STATUS.NOSTATE?i=[o.LIST_BUTTON.commit,o.LIST_BUTTON.delete,o.LIST_BUTTON.bodyUpdate]:v!=o.STATUS.PASSING&&v!=o.STATUS.COMMIT&&v!=o.STATUS.GOINGON||(i=[o.LIST_BUTTON.unCommit,o.LIST_BUTTON.approvalLink]),e.button.setButtonDisabled([].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(i),[o.LIST_BUTTON.print,o.LIST_BUTTON.output,o.LIST_BUTTON.attachment,o.LIST_BUTTON.linkGroup,o.LIST_BUTTON.billTrack]),!1)}},t.selectedAllEvent=function(e,t,a,n){if(e.button.setButtonDisabled(o.LIST_DISABLED_BUTTON,!0),e.table.getCheckedRows(o.LIST.table_id).length>0){var s=[],i=!0,r=!0,l=!0,c=e.table.getCheckedRows(o.LIST.table_id);s=[o.LIST_BUTTON.print,o.LIST_BUTTON.output];var d=!0,u=!1,p=void 0;try{for(var T,f=c[Symbol.iterator]();!(d=(T=f.next()).done);d=!0){var m=T.value.data.values[o.FIELD.billStatus].value;m==o.STATUS.PASSING||m==o.STATUS.COMMIT||m==o.STATUS.GOINGON?(r=!1,i=!1):m==o.STATUS.NOSTATE&&(l=!1)}}catch(e){u=!0,p=e}finally{try{!d&&f.return&&f.return()}finally{if(u)throw p}}i&&s.push(o.LIST_BUTTON.delete),r&&s.push(o.LIST_BUTTON.commit),l&&s.push(o.LIST_BUTTON.unCommit),e.button.setButtonDisabled(s,!1)}};var o=a(4)},4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APPCODE="M0Z10301",t.BILL_TYPE_CODE="SUMRULE",t.MULTILANG={moduleId:"M0Z10301",domainName:"hpf"},t.LIST={page_title:"M0Z10301-000011",page_code:"M0Z10301_LIST",search_id:"list_query",table_id:"list_head",head_btn_code:"list_head",body_btn_code:"list_inner"},t.CARD={page_title:"M0Z10301-000011",page_code:"M0Z10301_CARD",form_id:"card_head",table_code:"card_body",table_edit_code:"card_body_edit",table_browse_code:"card_body_browse",head_btn_code:"card_head",shoulder_btn_code:"tabs_head",body_btn_code:"tabs_body"};var o=t.DATASOURCE="tm.fmc.cost.datasource",n=(t.SEARCH_CACHE={key:"tm.fmc.cost.SEARCH_CACHE",dataSource:o},t.CARD_CACHE={key:"tm.fmc.cost.CARD_CACHE",dataSource:o},t.base_path="/nccloud/hpf/hpfc/",t.REQUEST_URL={save:"/nccloud/hpf/hpfc/savesumruleVO.do",delete:"/nccloud/hpf/hpfc/deletesumruleVO.do",queryCard:"/nccloud/hpf/hpfc/querycardsumruleVO.do",queryList:"/nccloud/hpf/hpfc/querypagesumruleVO.do",queryListByPks:"/nccloud/hpf/hpfc/querypagebypksumruleVO.do",commit:"/nccloud/hpf/hpfc/commitsumruleVO.do",unCommit:"/nccloud/hpf/hpfc/uncommitsumruleVO.do",setInitDataBefore:"/nccloud/hpf/hpfc/setinitdatabefore.do",setInitData:"/nccloud/hpf/hpfc/setinitdata.do",toCard:"/card",toList:"/list",queryColumn:"/nccloud/hpf/hpfc/queryColumn.do",print:"/nccloud/hpf/hpfc/HpfsumrulePrintAction.do"},t.LIST_BUTTON={create:"AddBtn",delete:"DelBtn",commit:"CommitBtn",unCommit:"UnCommitBtn",linkGroup:"JointBtn",attachment:"AttachmentBtn",approvalLink:"DetailBtn",billTrack:"TrackBtn",print:"Print",output:"Output",refresh:"RefreshBtn",setInitData:"InitData",bodyUpdate:"edit",bodyDelete:"delete",bodyCommit:"commit",bodyUnCommit:"unCommit",copy:"copy"}),s=(t.LIST_DISABLED_BUTTON=[n.delete,n.commit,n.unCommit,n.linkGroup,n.approvalLink,n.billTrack,n.attachment,n.print,n.output,n.bodyUpdate],t.CARD_BUTTON={save:"SaveBtn",saveAdd:"SaveAddBtn",saveCommit:"SaveCommitBtn",cancel:"CancelBtn",create:"CreateBtn",update:"UpdateBtn",delete:"DeleteBtn",copy:"CopyBtn",commit:"CommitBtn",unCommit:"UnCommitBtn",attachment:"AttachmentBtn",approvalLink:"DetailBtn",billTrack:"TrackBtn",print:"Print",output:"Output",refresh:"RefreshBtn",back:"Back",addRow:"addRow",deleteRow:"deleteRow",copyRows:"copyRows",pasteTail:"pasteTail",pasteCancel:"pasteCancel",expand:"expand",insertRow:"insertRow",delRow:"delRow",copyRow:"copyRow",fold:"fold",unfold:"unfold",pasteHere:"pasteHere"});t.CARD_DISABLED_BUTTON=[s.deleteRow,s.copyRows],t.CARD_ADD_DISABLED_BUTTON=[s.addRow,s.save,s.saveAdd,s.saveCommit],t.FIELD={org:"pk_org",billStatus:"approvestatus",ts:"ts",idissys:"idissys",idissysbilltype:"idissysbilltype"},t.PRIMARY_KEY={head_id:"pk_sumrule",body_id:"pk_sumrule_h",bill_no:"billno",id:"id"},t.STATUS={status:"status",edit:"edit",browse:"browse",add:"add",info:"info",warning:"warning",success:"success",danger:"danger",NOSTATE:"-1",NOPASS:"0",PASSING:"1",GOINGON:"2",COMMIT:"3"},t.COLS_EDITABLE={sr_xm:["vchargetypecode","vchargetypename","vexedeptcode","vexedeptname","vapplydeptcode","vapplydeptname","vapplydoctorcode","vapplydoctorname","dinprice","valuationnmny"]},t.editcfg=new Map([["CP04",["vchargetypecode","vchargetypename","vexedeptcode","vexedeptname","vapplydeptcode","vapplydeptname","vapplydoctorcode","vapplydoctorname","dinprice","valuationnmny"]],["0001ZZZZD01EE175077C",["vdeptcode","vdeptname","vfundsourcecode","vfundsourcename"]],["0002ZZZZD01EE175077C",["vdeptcode","vdeptname","vfundsourcecode","vfundsourcename"]],["0001ZZZZF7A86CABE5A7",["vdeptcode","vdeptname","vequipcode","vequipname","vfundsourcecode","vfundsourcename"]],["0001ZZZZE193F6699639",["vdeptcode","vdeptname","vfundsourcecode","vfundsourcename"]],["0002ZZZZE193F6699639",["vdeptcode","vdeptname","vfundsourcecode","vfundsourcename"]],["DG11",["acceptrefund","billscode","billstype","dbusdate","diagnosiscode","diagnosisname","dinprice","executedeptcodeone","executedeptcodethree","executedeptcodetwo","executedeptnamefour","executedeptnameone","executedeptnamethree","executedeptnametwo","executedoctorcodeone","executedoctorcodethree","executedoctorcodetwo","executedoctornamefour","executedoctornameone","executedoctornamethree","executedoctornametwo","fetrange","medicaltype","nmny","nquantity","pawpaynmny","pk_mid_clinic_income","syscode","transtype","valuationnmny","vapplydeptcode","vapplydeptname","vapplydoctorcode","vapplydoctorname","vchargercode","vchargername","vcustcode","vcustname","vexedeptcode","vexedeptname","vincomeclass","vincometypecode","vincometypename","vnote","vpatientcode","vpatientname","vpayorgtypecode","vpayorgtypename","vpaywaycode","vpaywayname","vtranswayname","vbrcbcode","vbrcbname","jzcode","hospitalnumber"]],["DG10",["cydeptcode","cydeptname","period","patientcode","patientname","age","sex","bano","zyno","zycnt","zyday","ybtype","rydate","cydate","cystatus","ndccode","ndcname","drgcode","drgname","rw","zyallmny","majorzd","minorzd1","majorzd2","minorzd3","minorzd4","majorss","majorss1","majorss2","majorss3","majorss4"]],["DG31",["admittedcode","admittedname","outdeptcode","outdeptname","admissiondate","age","dischargedate","dischargenmy","hospitaldays","hospitalnumber","infectcode","infectname","instypecode","instypename","leavestatuscode","leavestatusname","maindiagnosecode","maindiagnosename","mainsurgerycode","mainsurgeryname","medicalno","minordiagnose1code","minordiagnose1name","minordiagnose2code","minordiagnose2name","minordiagnose3code","minordiagnose3name","minordiagnose4code","minordiagnose4name","minorsurgery1code","minorsurgery1name","minorsurgery2code","minorsurgery2name","minorsurgery3code","minorsurgery3name","minorsurgery4code","minorsurgery4name","patienttype","period","pk_mid_medicrec_page","rescuenum","residentdoctorcode","residentdoctorname","sex","singlediseasecode","singlediseasename","successnum","syscode","vpatientcode","vpatientname"]]])},79:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n,s,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),l=a(1),c=(s=l)&&s.__esModule?s:{default:s},d=a(0),u=a(80),p=a(82),T=a(83),f=a(38),m=a(4),h=a(20);function v(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _=d.high.PrintOutput,b=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.call(a),a.state={json:{},showUploader:!1,billInfo:{},compositeData:null,compositeDisplay:!1,curPk:null,showApproveDetail:!1,billId:null},e.use.table(m.LIST.table_id),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentWillMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:m.MULTILANG.moduleId,domainName:m.MULTILANG.domainName,callback:function(t,a,o){a&&(u.initTemplate.call(e,e.props),e.setState({json:t,inlt:o}))}})}},{key:"componentDidMount",value:function(){(0,d.cardCache.getDefData)(m.SEARCH_CACHE.key,m.SEARCH_CACHE.dataSource)?this.props.button.setDisabled(v({},m.LIST_BUTTON.refresh,!1)):this.props.button.setDisabled(v({},m.LIST_BUTTON.refresh,!0))}},{key:"render",value:function(){var e=this,t=this.props,a=t.table,o=t.search,n=a.createSimpleTable,s=o.NCCreateSearch,r=d.high.NCUploader,l=d.high.BillTrack,u=d.high.ApprovalTrans;d.high.ApproveDetail;return c.default.createElement("div",{className:"nc-bill-list"},c.default.createElement("div",{className:"nc-bill-header-area"},c.default.createElement("div",{className:"header-title-search-area"},(0,d.createPageIcon)(),c.default.createElement("h2",{className:"title-search-detail"},"数据汇总规则")),c.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:m.LIST.head_btn_code,onButtonClick:p.buttonClick.bind(this)}))),c.default.createElement("div",{className:"nc-bill-search-area"},s(m.LIST.search_id,{clickSearchBtn:this.clickSearchBtn,onAfterEvent:this.afterEvent})),c.default.createElement("div",{className:"nc-bill-table-area"},n(m.LIST.table_id,{showCheck:!0,showIndex:!0,dataSource:m.SEARCH_CACHE.dataSource,pkname:m.PRIMARY_KEY.head_id,handlePageInfoChange:this.handlePageInfoChange,onRowDoubleClick:this.onRowDoubleClick,onSelected:this.clickSelectBtn,onSelectedAll:this.clickSelectAllBtn})),this.state.showUploader&&c.default.createElement(r,i({placement:"bottom"},this.state.billInfo,{onHide:function(){e.setState({showUploader:!1})}})),c.default.createElement(l,{show:this.state.showBillTrack,close:function(){e.setState({showBillTrack:!1})},pk:this.state.billTrackBillId,type:this.state.billTrackBillType}),this.state.compositeDisplay&&c.default.createElement(u,{title:this.state.json["M0Z10301-000018"],data:this.state.compositeData,display:this.state.compositeDisplay,getResult:this.getAssignUser,cancel:this.compositeTurnOff}),c.default.createElement(_,{ref:"printOutput",url:m.REQUEST_URL.print,data:{funcode:m.APPCODE,nodekey:m.APPCODE,oids:this.state.ids,outputType:"output"}}))}}]),t}(l.Component),n=function(){var e=this;this.handlePageInfoChange=function(t,a,o){(0,h.pageInfoClick)(i({},t,{json:e.state.json}),a,o)},this.onRowDoubleClick=function(t,a,o){(0,h.handleDoubleClick)(t,a,i({},o,{json:e.state.json}))},this.clickSearchBtn=function(t){(0,T.searchBtnClick)(i({},t,{json:e.state.json}))},this.afterEvent=function(t,a){if("idissys"===t&&(e.props.search.setTemlateByField(m.LIST.search_id,"idissysbilltype","queryCondition",{idissys:a,GridRefActionExt:"nccloud.web.hpf.sumrulevo.refsqlbuilder.AllBillRefSqlBuilder"}),e.props.search.setSearchValByField(m.LIST.search_id,"idissysbilltype",{display:"",value:""})),"idissysbilltype"===t){var o=e.props.search.getSearchValByField(m.LIST.search_id,"idissys").value.firstvalue;e.props.search.setTemlateByField(m.LIST.search_id,"midmetadata","queryCondition",{idissys:o,idissysbilltype_code:a.refcode,idissysbilltype_pk:a.refpk,GridRefActionExt:"nccloud.web.hpf.sumrulevo.refsqlbuilder.MdEntityRefSqlBuilder"})}},this.clickSelectBtn=function(e,t,a,o,n){(0,f.selectedEvent)(e,t,a,o,n)},this.clickSelectAllBtn=function(e,t,a,o){(0,f.selectedAllEvent)(e,t,a,o)},this.getAssignUser=function(t){(0,h.listCommit)(i({},e.props,{json:e.state.json}),{pks:e.state.curPk,userObj:t}),e.compositeTurnOff()},this.compositeTurnOff=function(){e.setState({compositeData:null,compositeDisplay:!1})}},o);b=(0,d.createPage)({})(b),t.default=b},80:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=function(e){var t=this;e.createUIDom({pagecode:o.LIST.page_code},(function(a){if(a){if(a.button){var i=a.button;e.button.setButtons(i),e.button.setPopContent(o.LIST_BUTTON.bodyDelete,t.state.json["M0Z10301-000008"]),e.button.setButtonDisabled(o.LIST_DISABLED_BUTTON,!0)}if(a.template){var r=a.template;if(r=s.call(t,e,r),a.context&&a.context.pk_org){var l=a.context,c=l.pk_org,d=l.org_Name;r[o.LIST.search_id].items.map((function(e){e.attrcode==o.FIELD.org&&(e.initialvalue={display:d,value:c})}))}if(r[o.LIST.search_id].items.map((function(e){e.attrcode==o.FIELD.org&&(e.isMultiSelectedEnabled=!1)})),e.meta.setMeta(r),a.context&&a.context.pk_org){var u=e.search.getSearchValByField(o.LIST.search_id,o.FIELD.org);if(!u||!u.value){var p=a.context,T=p.pk_org,f=p.org_Name;e.search.setSearchValByField(o.LIST.search_id,o.FIELD.org,{display:f,value:T})}}var m=t.props.search.getSearchValByField(o.LIST.search_id,"idissys").value.firstvalue;t.props.search.setTemlateByField(o.LIST.search_id,"idissysbilltype","queryCondition",{idissys:m,GridRefActionExt:"nccloud.web.hpf.sumrulevo.refsqlbuilder.AllBillRefSqlBuilder"}),t.props.search.setSearchValByField(o.LIST.search_id,"idissysbilltype",{display:"",value:""}),(0,n.selectedEvent)(e)}}}))};var o=a(4),n=(a(81),a(38));function s(e,t){return t[o.LIST.table_id].pagination=!0,t[o.LIST.table_id].items=t[o.LIST.table_id].items.map((function(t,a){return t.attrcode==o.PRIMARY_KEY.bill_no&&(t.render=function(t,a,n){return React.createElement("a",{style:{cursor:"pointer"},onClick:function(){e.pushTo(o.REQUEST_URL.toCard,{status:o.STATUS.browse,id:a[o.PRIMARY_KEY.head_id].value,pagecode:o.CARD.page_code})}},a[o.PRIMARY_KEY.bill_no]&&a[o.PRIMARY_KEY.bill_no].value)}),t})),t}},81:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.bodyButtonClick=function(e,t,a,i,r){var l=i[n.PRIMARY_KEY.head_id]&&i[n.PRIMARY_KEY.head_id].value,c=i[n.FIELD.ts]&&i[n.FIELD.ts].value,d=new Map;l&&c&&d.set(l,c);switch(t){case n.LIST_BUTTON.bodyUpdate:(0,s.listEdit)(e,l);break;case n.LIST_BUTTON.bodyDelete:(0,s.listBodyDelete)(o({},e,{json:this.state.json}),{pks:[l],pkMapTs:d},r);break;case n.LIST_BUTTON.copy:(0,s.listCopy)(e,l);break;case n.LIST_BUTTON.bodyCommit:s.listCommit.call(this,o({},e,{json:this.state.json}),{pks:[l],pkMapTs:d});break;case n.LIST_BUTTON.bodyUnCommit:(0,s.listUnCommit)(o({},e,{json:this.state.json}),{pks:[l],pkMapTs:d})}};var n=a(4),s=a(20)},82:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.buttonClick=function(e,t,a,r,l){var c=this;switch(t){case i.LIST_BUTTON.create:(0,s.listCreate)(e);break;case i.LIST_BUTTON.bodyUpdate:var d=e.table&&e.table.getCheckedRows(i.LIST.table_id),u=d[0].data.values[i.PRIMARY_KEY.head_id]&&d[0].data.values[i.PRIMARY_KEY.head_id].value;(0,s.listEdit)(e,u);break;case i.LIST_BUTTON.delete:(0,n.promptBox)({color:i.STATUS.warning,title:this.state.json["M0Z10301-000000"],content:this.state.json["M0Z10301-000001"],beSureBtnClick:function(){(0,s.listHeadDelete)(o({},e,{json:c.state.json})),e.button.setButtonDisabled(i.LIST_DISABLED_BUTTON,!0)}});break;case i.LIST_BUTTON.attachment:s.listAttachment.call(this,o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.billTrack:s.listBillTrack.call(this,o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.approvalLink:s.listLinkApprove.call(this,o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.commit:s.listCommit.call(this,o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.unCommit:(0,s.listUnCommit)(o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.refresh:(0,s.listRefresh)(o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.setInitData:(0,s.initDataBefore)(o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.print:(0,s.onPrint)(o({},e,{json:this.state.json}));break;case i.LIST_BUTTON.output:s.onOutput.call(this,o({},e,{json:this.state.json}))}};var n=a(0),s=a(20),i=a(4)},83:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchBtnClick=function(e){(0,o.listSearch)(e)};var o=a(20)}})}));