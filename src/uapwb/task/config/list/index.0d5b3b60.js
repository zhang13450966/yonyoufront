/*! @ncctag {"project":"","branch":"","provider":"","date":"2022/7/15 下午8:36:29"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["uapwb/task/config/list/index"]=t():e["uapwb/task/config/list/index"]=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../../../../",r(r.s=5)}([,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PAGE_CONST={tableId:"list",btnHeadId:"task-config-header",btnTableId:"task-config-table",pageCode:"101805COFG_page"},t.URLS={query:"/nccloud/ffw/servicemap/query.do",save:"/nccloud/ffw/servicemap/save.do",delete:"/nccloud/ffw/servicemap/delete.do",tasktypeRef:"/nccloud/ffw/tasktype/ref.do",querySelectData:"/nccloud/ffw/servicemap/queryservicename.do"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTableData=void 0;t.getTableData=(n=regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={pagecode:$appRoot.props.getSearchParam("p"),areacode:o.PAGE_CONST.tableId},e.next=3,$util.ajax(o.URLS.query,t);case 3:r=e.sent,n=_.get(r,"data.list")||{rows:[]},$appRoot.props.editTable.setTableData(o.PAGE_CONST.tableId,n);case 6:case"end":return e.stop()}}),e,this)})),a=function(){var e=n.apply(this,arguments);return new Promise((function(t,r){return function n(a,o){try{var i=e[a](o),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(u)}("next")}))},function(){return a.apply(this,arguments)});var n,a,o=r(1)},,,function(e,t,r){"use strict";var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(6),i=r(7),u=r(8),c=r(2),s=r(1);var p=$platform.createPage({billinfo:{billtype:"grid",pagecode:s.PAGE_CONST.pageCode,bodycode:s.PAGE_CONST.tableId}})(n=$util.AppWrapper({use:{editTable:["list"]},autoDisplay:{},pageId:"task_config"})(n=function(e){function t(e){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n,a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={json:{}},a.initData=(n=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $platform.getMultiLang({moduleId:"101805COFG",domainName:"uapwb",callback:function(e){a.setState({json:e})}}),e.next=3,o.initTemplate.call(a);case 3:(0,c.getTableData)();case 4:case"end":return e.stop()}}),e,r)})),function(){var e=n.apply(this,arguments);return new Promise((function(t,r){return function n(a,o){try{var i=e[a](o),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(u)}("next")}))}),a.initData(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,React.Component),a(t,[{key:"render",value:function(){return React.createElement("div",{className:"nc-single-table"},React.createElement(u.HeaderArea,null),React.createElement(i.Table,null))}}]),t}())||n)||n;ReactDOM.render(React.createElement(p,null),document.querySelector("#app"))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=void 0;var n,a,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=(t.initTemplate=(n=s(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTemplate();case 2:t=e.sent,r=t.template,n=t.button,p.call(this,r),l.call(this,n);case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),a=s(regeneratorRuntime.mark((function e(){var t,r,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,r={pagecode:u.PAGE_CONST.pageCode,bodycode:u.PAGE_CONST.tableId},e.next=4,$util.ajax(u.URLS.querySelectData,r);case 4:(n=e.sent).success&&t.createUIDom({pagecode:u.PAGE_CONST.pageCode},(function(e){var r=e.template,i=[].concat(c(r[u.PAGE_CONST.tableId].items)),p=i.find((function(e){return"servicename"===e.attrcode})),l=[];n.data.forEach((function(e){var t={};t.value=t.display=e,l.push(t)})),p.itemtype="select",p.options=l;var f=i.find((function(e){return"opr"===e.attrcode}));f.itemtype="customer",f.render=function(e,t,r){var n,o={DelTable:{handler:(n=s(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_.get(t,"values.pk_taskservicemap.value"),log.info("record, pk",t,n),!n){e.next=6;break}return o={pageid:$appRoot.props.getSearchParam("p"),model:{areaType:"table",areacode:u.PAGE_CONST.tableId,rows:[t]}},e.next=6,$util.ajax(u.URLS.delete,o);case 6:$appRoot.props.editTable.deleteTableRowsByIndex(u.PAGE_CONST.tableId,r,!0),$util.toast($appRoot.state.json["101805COFG-000000"],$const.SPELL.success);case 8:case"end":return e.stop()}}),e,a)}))),function(){return n.apply(this,arguments)})}};return a.props.button.createOprationButton(Object.keys(o),{area:u.PAGE_CONST.btnTableId,buttonLimit:3,onButtonClick:function(e,t){return o[t].handler()}})},r.list.pagination=!0,r.list.items=[].concat(c(i)),t.meta.setMeta(o({},e.template))}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)}),u=r(1);function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function s(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(a,o){try{var i=t[a](o),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(u)}("next")}))}}function p(e){i.call(this,e),this.props.meta.setMeta(e)}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.props.button.setButtonsVisible({Save:!1,Cancel:!1}),this.props.button.setButtons(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Table=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(1);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.Table=function(e){function t(){var e,r,a;i(this,t);for(var o=arguments.length,c=Array(o),s=0;s<o;s++)c[s]=arguments[s];return r=a=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.onAfterEvent=function(e,t,r,a,o,i,u){if("pk_distributetasktype"===r){console.log(e,t,r,a,o,i,u,"obj");var c=i,s=u.values.pk_distributetasktype.display;o.forEach((function(e,r){if(0===r)u.values.pk_distributetasktype.value=e.newvalue.value,u.values.pk_distributetasktype.display=s.split(",")[r],u.values.servicename.display=u.values.servicename.value;else{var a=n({},u.values);a.pk_distributetasktype=n({},u.values.pk_distributetasktype),a.pk_distributetasktype.value=e.newvalue.value,a.pk_distributetasktype.display=s.split(",")[r],a.servicename.display=a.servicename.value,delete a.pk_taskservicemap,$appRoot.props.editTable.addRow(t,c++,!1,a)}}))}},u(a,r)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,React.Component),a(t,[{key:"render",value:function(){return React.createElement("div",{className:"nc-singleTable-table-area"},$appRoot.props.editTable.createEditTable(o.PAGE_CONST.tableId,{showCheck:!0,showIndex:!0,isAddRow:!0,adaptionHeight:!0,onAfterEvent:this.onAfterEvent}))}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderArea=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),o=r(9);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c={Add:o.Add,Edit:o.Edit,Del:o.Del,Save:o.Save,Cancel:o.Cancel,Refresh:o.Refresh};t.HeaderArea=function(e){function t(){return i(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,React.Component),n(t,[{key:"render",value:function(){return React.createElement("div",{className:"nc-singleTable-header-area"},React.createElement("div",{className:"header-title-search-area"},$platform.createPageIcon(),React.createElement("h2",{className:"title-search-detail"},$appRoot.props.getSearchParam("n"))),React.createElement("div",{className:"header-button-area"},$appRoot.props.button.createButtonApp({area:a.PAGE_CONST.btnHeadId,onButtonClick:function(e,t){return c[t]()}})))}}]),t}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveBak=t.Del=void 0;var n,a;t.Del=(n=u(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$appRoot.props.editTable.getCheckedRows(o.PAGE_CONST.tableId),r=[],t.forEach((function(e){_.get(e,"data.values.pk_taskservicemap.value")&&r.push(e.data)})),!r.length){e.next=11;break}return n={pageid:$appRoot.props.getSearchParam("p"),model:{areaType:"table",areacode:o.PAGE_CONST.tableId,rows:r}},e.next=7,$util.ajax(o.URLS.delete,n);case 7:$util.toast($appRoot.state.json["101805COFG-000000"],$const.SPELL.success),$appRoot.props.editTable.deleteTableRowsByIndex(o.PAGE_CONST.tableId,_.map(t,"index"),!0),e.next=12;break;case 11:$util.toast("请选择需要删除的任务！",$const.SPELL.warning);case 12:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),t.SaveBak=(a=u(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($appRoot.props.editTable.filterEmptyRows(o.PAGE_CONST.tableId),(t=$appRoot.props.editTable.getChangedRows(o.PAGE_CONST.tableId)).length){e.next=4;break}return e.abrupt("return",$util.toast($appRoot.state.json["101805COFG-000001"],$const.SPELL.warning));case 4:return r={pageid:$appRoot.props.getSearchParam("p"),model:{areaType:"table",areacode:o.PAGE_CONST.tableId,rows:t}},e.next=7,$util.ajax(o.URLS.save,r);case 7:e.sent.success&&(s(),p());case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)});t.Add=function(){c(),$appRoot.props.editTable.addRow(o.PAGE_CONST.tableId)},t.Edit=c,t.Save=function(){var e=this,t=$appRoot.props,r=o.PAGE_CONST.tableId;t.editTable.filterEmptyRows(r);var n=t.editTable.getVisibleRows(r);if(!t.editTable.checkRequired(r,n))return;var a=t.editTable.getChangedRows(r);if(!_.get(a,"length"))return $util.toast($appRoot.state.json["101805COFG-000001"],$const.SPELL.warning);var i={pageid:$appRoot.props.getSearchParam("p"),model:{areaType:"table",areacode:o.PAGE_CONST.tableId,rows:a}};t.validateToSave(i,u(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$util.ajax(o.URLS.save,i);case 2:r=e.sent,n=r.success,r.data,n&&(s(),p());case 5:case"end":return e.stop()}}),t,e)}))))},t.Refresh=s,t.Cancel=p;var o=r(1),i=r(2);function u(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(a,o){try{var i=t[a](o),u=i.value}catch(e){return void r(e)}if(!i.done)return Promise.resolve(u).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(u)}("next")}))}}function c(){$appRoot.props.button.setButtonsVisible({Save:!0,Cancel:!0,Refresh:!1}),$appRoot.props.button.setButtonDisabled({Del:!0,Edit:!0}),$appRoot.props.editTable.setStatus(o.PAGE_CONST.tableId,$const.SPELL.edit)}function s(){(0,i.getTableData)()}function p(){$appRoot.props.button.setButtonsVisible({Save:!1,Cancel:!1,Refresh:!0}),$appRoot.props.button.setButtonDisabled({Del:!1,Edit:!1}),$appRoot.props.editTable.cancelEdit(o.PAGE_CONST.tableId,s),$appRoot.props.editTable.setStatus(o.PAGE_CONST.tableId,$const.SPELL.browse)}}])}));
//# sourceMappingURL=index.0d5b3b60.js.map